import axios from 'axios'
import { useEffect, useState } from 'react'

// ðŸŒžðŸŒžðŸŒžðŸŒžðŸŒž
// 1. ë¦¬ì•¡íŠ¸ì—ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ë²•

// ðŸŒž ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ(useEffect) ì²˜ë¦¬
// ë°ì´í„° íŒ¨íŒ…í•˜ê¸°
// ë¡œë”© ë° ì—ëŸ¬ì²˜ë¦¬

// - ë¬¸ì œì 
// ìƒíƒœ ê´€ë¦¬ì˜ ë³µìž¡ì„±(ê° ìƒíƒœì— ë”°ë¥¸ ë¡œì§ì´ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ë¶„ì‚°)
// ì¤‘ë³µëœ ì½”ë“œ
// ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ë¶„ë¦¬ ë¶€ì¡±( í•µì‹¬ ë™ìž‘ì„ ì •ì˜í•˜ëŠ” ì½”ë“œ, UI í˜¼í•©ìœ¼ë¡œ ê°€ë…ì„± í•˜ë½)
// ì„œë²„ ìƒíƒœ ê´€ë¦¬ì˜ ì–´ë ¤ì›€

// - ì„œë²„ ìƒíƒœ vs í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ
// í´ë¼ì´ì–¸íŠ¸ ìƒíƒœëŠ” UI ê´€ë ¨ëœ ì¼ì‹œì ì¸ ë°ì´í„°(ì˜ˆ: í¼ ìž…ë ¥ê°’)ë¥¼ ì˜ë¯¸
// ì„œë²„ ìƒíƒœëŠ” ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ë°ì´í„°(ì˜ˆ: API ì‘ë‹µ), ìºì‹±, ë™ê¸°í™”, ìž¬ê²€ì¦(revalidate)

// ðŸŒž í•´ê²°ì±…
// 1. Redux Middleware ì´ìš©
// ì•¡ì…˜ì´ ë¦¬ë“€ì„œì— ë„ë‹¬í•˜ê¸° ì „ì— ì¤‘ê°„ì—ì„œ ê°€ë¡œì±„ì„œ ì¶”ê°€ì ì¸ ìž‘ì—…ì„ ìˆ˜í–‰
// ë¹„ë™ê¸° ë¡œì§ì„ ì²˜ë¦¬(Redux Thunk, Redux Saga, Redux Observable â€¦), ë¡œê·¸ë¥¼ ê¸°ë¡(redux-logger), ì—ëŸ¬ë¥¼ ì²˜ë¦¬

// - ì¼ë°˜ reduxì˜ ì²˜ë¦¬ ë°©ì‹
// UI ì»´í¬ë„ŒíŠ¸ì—ì„œ dispatch ->
// dispatchê°€ ì¼ì–´ë‚  ë•Œ action ê°ì²´ë¥¼ dispatch ->
// action ê°ì²´ëŠ” ë¦¬ë“€ì„œë¡œ ì „ë‹¬ë˜ì–´ Redux storeë¥¼ ì—…ë°ì´íŠ¸

// - redux thunkì˜ ì²˜ë¦¬ ë°©ì‹
// UI ì»´í¬ë„ŒíŠ¸ì—ì„œ dispatch ->
// dispatchê°€ ì¼ì–´ë‚  ë•Œ thunk í•¨ìˆ˜(ë¹„ë™ê¸° ìž‘ì—… í¬í•¨)ë¥¼ dispatch ->
// ì „ë‹¬ëœ thunk í•¨ìˆ˜ì— ì˜í•´ Redux Thunk ë¯¸ë“¤ì›¨ì–´ê°€ ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³ , í•¨ìˆ˜ ì•ˆì—ì„œ ë¹„ë™ê¸° ìž‘ì—…ì„ ìˆ˜í–‰ ->
// ë¹„ë™ê¸° ë¡œì§ì´ ìˆ˜í–‰ëœ ì´í›„ í•„ìš”ì— ë”°ë¼ ì•¡ì…˜ ê°ì²´ë¥¼ ë³„ë„ë¡œ ìƒì„±í•˜ì—¬ dispatch ->
// dispatchëœ ì•¡ì…˜ ê°ì²´ëŠ” ë¦¬ë“€ì„œë¡œ ì „ë‹¬ë˜ì–´ Redux storeë¥¼ ì—…ë°ì´íŠ¸

// - Redux Thunk
// ìƒíƒœ ê´€ë¦¬ì˜ ì¼ê´€ì„± (Redux Thunkë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸° ë¡œì§ì„ ì¤‘ì•™ì—ì„œ ê´€ë¦¬)
// ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ë¶„ë¦¬(ë¹„ë™ê¸° ë¡œì§ì„ ì•¡ì…˜ í¬ë¦¬ì—ì´í„°ë¡œ ë¶„ë¦¬í•˜ì—¬ UI ë¡œì§ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë¶„ë¦¬í•˜ê³ , ìœ ì§€ë³´ìˆ˜ì„±ê³¼ ê°€ë…ì„±ì„ í–¥ìƒ)
// ë¡œë”© ë° ì—ëŸ¬ ìƒíƒœ ê´€ë¦¬ì˜ ìš©ì´ì„± (Redux Thunkì™€ Redux Toolkitì„ ì‚¬ìš©í•˜ì—¬ isLoadingê³¼ isError ë“±ì˜ ìƒíƒœë¥¼ ì¤‘ì•™ì—ì„œ ì¼ê´€ë˜ê²Œ ê´€ë¦¬, ìƒíƒœ ë³€í™”ì— ë”°ë¥¸ UI ì—…ë°ì´íŠ¸ê°€ ìš©ì´)

// - ë¶ˆíŽ¸í•œ ì 
// ë³µìž¡ì„± ì¦ê°€ : ì•¡ì…˜ í¬ë¦¬ì—ì´í„°ì™€ ë¦¬ë“€ì„œì˜ ì½”ë“œê°€ ê¸¸ê³ , ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ(ë°˜ë³µì ì´ê³  í‹€ì— ë°•ížŒ ì½”ë“œ)ê°€ ë§Žì•„ì ¸ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›€
// í…ŒìŠ¤íŠ¸ê°€ ë³µìž¡ : ì•¡ì…˜ í¬ë¦¬ì—ì´í„°ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ë³µìž¡í•˜ë©°, ë‹¤ì–‘í•œ ì‘ë‹µ ìƒíƒœì™€ ë¹„ë™ê¸° ìž‘ì—…ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸° ìœ„í•œ ë³„ë„ì˜ ìž¥ì¹˜ê°€ í•„ìš”í•´ í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ë³µìž¡

// ðŸŒž TanStack Query(React Query) : ëŒ€ì•ˆ
// ë³µìž¡í•œ ë¹„ë™ê¸° ë¡œì§ì„ ë‹¨ìˆœí™”
// ìºì‹±, ë™ê¸°í™”, ë¦¬íŽ˜ì¹­
//  ì„ ì–¸ì ì¸ ë°ì´í„° íŒ¨ì¹­, ìžë™ ë¦¬íŽ˜ì¹­, ìºì‹± ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ ì„œë²„ ìƒíƒœ ê´€ë¦¬ë¥¼ ë” ì‰½ê³  íš¨ìœ¨ì 

export default function Async() {
  const [data, setData] = useState(null)
  // 2. ë¡œë”© ë° ì—ëŸ¬ ì²˜ë¦¬
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  // 1. ë°ì´í„° íŒ¨ì¹­í•˜ê¸°
  useEffect(() => {
    const fetchData = async () => {
      setLoading(true)
      try {
        const response = await axios.get('http://localhost:4000/todos')
        setData(response.data)
      } catch (error) {
        setError(error)
      } finally {
        setLoading(false)
      }
    }

    fetchData()
  }, [])

  if (loading) return <div>Loading...</div>
  if (error) return <div>Error: {error.message}</div>

  return (
    <div>
      <h1>Fetched Data</h1>
      <ul>
        {data &&
          data.map((item) => (
            <li key={item.id}>
              <h2>{item.title}</h2>
              <p>{item.isDone ? 'Done' : 'Not Done'}</p>
            </li>
          ))}
      </ul>
    </div>
  )
}
